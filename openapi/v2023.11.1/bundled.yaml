components:
  schemas:
    Webhook:
      required:
        - payloadUrl
        - contentType
        - subscribedEvents
        - disabled
        - secretKey
        - skipSslVerification
        - timestamp
      type: object
      title: Webhook
      properties:
        id:
          type: string
          description: Webhook Id
        orgId:
          type: string
          description: Organisation Id
        payloadUrl:
          type: string
          description: Webhook payload Url
        contentType:
          type: string
          description: Webhook payload content type
          enum:
            - application/json
            - application/x-www-form-urlencoded
        subscribedEvents:
          type: array
          items:
            type: string
            description: Subscribed event
            enum:
              - consent.allowed
              - consent.disallowed
        disabled:
          type: boolean
          description: Is webhook disabled or not
        secretKey:
          type: string
          description: Secret key for checking authenticity of the source
        skipSslVerification:
          type: boolean
          description: Skip SSL verification for webhook Url
        timestamp:
          type: string
          description: Creation timestamp
    Pagination:
      type: object
      title: Pagination
      properties:
        currentPage:
          type: integer
          description: Current page number
        totalItems:
          type: integer
          description: Total number of items available
        totalPages:
          type: integer
          description: Total number of pages based on limit
        limit:
          type: integer
          description: Number of items per page
        hasPrevious:
          type: boolean
          description: Indicates if there's a previous page
        hasNext:
          type: boolean
          description: Indicates if there's a next page
    DataAgreement:
      type: object
      title: DataAgreement
      description: |
        An agreement contains the specification of a single purpose that can be consented to.  An DataAgreement is universal and can be consented to by *many* individuals through a DataAgreementRecord"
      x-not-in-database: false
      required:
        - purpose
        - purposeDescription
        - controllerUrl
        - controllerName
        - policy
        - lawfulBasis
        - methodOfUse
        - active
        - forgettable
        - lifecycle
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        version:
          type: string
          format: ''
          example: ''
          description: The version of this specification to which a receipt conforms
        controllerId:
          type: string
          description: ID of the controller
        controllerUrl:
          type: string
          description: URL of data controller (may be omitted if no data involved)
        controllerName:
          type: string
          description: Name of data controller (may be omitted if no data involved)
        policy:
          $ref: '#/components/schemas/Policy'
          description: |
            Policy under which this DataAgreement shall be governed.  When creating a data agreement, the latest policy can be used to fill the default value,  and organisation admin can decide to change it in data agreement level
        dataAttributes:
          type: array
          items:
            type: object
            description: Data attribute contains specifications of exactly what is collected.
            x-not-in-database: false
            required:
              - name
              - description
            properties:
              id:
                type: string
                format: ''
                example: ''
                description: Data attribute Id
              name:
                type: string
                format: ''
                example: ''
                description: 'Name of the attribute, for instance "name" or "age"'
              description:
                type: string
                format: ''
                example: ''
                description: Description of the attribute
              sensitivity:
                type: boolean
                format: ''
                example: ''
                description: Sensitivity of data attribute
              category:
                type: string
                format: ''
                example: ''
                description: Category for data attribute
          description: |
            "Data attribute contains specifications of exactly what is collected."
        purpose:
          type: string
          description: Name of purpose
        purposeDescription:
          type: string
          description: Description of purpose
        lawfulBasis:
          type: string
          format: ''
          example: ''
          description: Lawful basis of the agreement - consent / legal_obligation / contract / vital_interest / public_task / legitimate_interest
          enum:
            - consent
            - legal_obligation
            - contract
            - vital_interest
            - public_task
            - legitimate_interest
        methodOfUse:
          type: string
          format: ''
          example: ''
          description: null/data_source/data_using_service
          enum:
            - null
            - data_source
            - data_using_service
        dpiaDate:
          type: string
          format: ''
          example: ''
          description: The date on which the DPIA report is generated after a DPIA
        dpiaSummaryUrl:
          type: string
          description: 'The URl providing the DPIA result reports, summary etc that can be verified by any interested parties'
        signature:
          $ref: '#/components/schemas/Signature'
          x-fk-model: Signature
          description: |
            Signature of authorizing party of DataAgreement.  Note: Signatures may be chained in case of multiple signatures.
        active:
          type: boolean
          format: ''
          example: ''
          description: DataAgreement is active and new DataAgreementRecords can be created.
        forgettable:
          type: boolean
          format: ''
          example: ''
          description: 'DataAgreementRecord may be deleted when consent is withdrawn, as its existence is not necessary for auditability.'
        compatibleWithVersionId:
          type: string
          format: ''
          x-fk-model: DataAgreement
          description: |
            WIP: This field indicates that Data Agreement Records may be transferred from this  compatible previous revision of the same DataAgreement.
        lifecycle:
          type: string
          description: |
            WIP: Current Lifecycle state of the DataAgreement.  Lifecycle states are used to manage internal workflows and  should not be assigned semantic meanings for active Data Agreement Records.
          enum:
            - draft
            - complete
    AgreementData:
      type: object
      title: AgreementData
      description: DataAgreement data contains specifications of exactly what is collected.
      x-not-in-database: false
      required:
        - id
        - name
        - sensitivity
        - category
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        agreement:
          $ref: '#/components/schemas/DataAgreement'
          x-fk-model: DataAgreement
          description: ''
        name:
          type: string
          format: ''
          example: ''
          description: 'Name of the attribute, for instance "name" or "age"'
        sensitivity:
          type: string
          format: ''
          example: ''
          description: categories of sensitivity
        category:
          type: string
          format: ''
          example: ''
          description: ''
    AgreementFilter:
      type: object
      title: AgreementFilter
      description: Query filter for API endpoint listing DataAgreement objects
      x-not-in-database: true
      required:
        - name
      properties:
        name:
          type: string
          format: ''
          example: ''
          description: ''
    AgreementLifecycle:
      type: object
      title: AgreementLifecycle
      description: 'TBD: Models the valid lifecycle states of an DataAgreement'
      x-not-in-database: false
      required:
        - id
        - name
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        name:
          type: string
          format: ''
          example: ''
          description: Draft / Complete
    AgreementPurpose:
      type: object
      title: AgreementPurpose
      description: 'TBD: Models the purpose of an agreement'
      x-not-in-database: false
      required:
        - id
        - name
        - description
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        name:
          type: string
          format: ''
          example: ''
          description: Name of purpose
        description:
          type: string
          format: ''
          example: ''
          description: Description of purpose
        serializedHash:
          type: string
          format: ''
          example: ''
          description: 'In order to sign an DataAgreement, this relation needs to have a cryptopgraphic hash of the JSON serialized data to be included in the Signature payload of the DataAgreement. Hashes are collected as the hex representation of the SHA-1 sum of all UTF8 encoded string versions of the JSON representation of data. SHA1(jsonSerializedData)'
    AuditEventType:
      type: object
      title: AuditEventType
      description: 'TBD: Model for the possible events pertaining a change to an object subject to auditing. This model is not necessarily a database-backed model, but part of application code.'
      x-not-in-database: false
      required:
        - id
        - eventName
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        eventName:
          type: string
          format: ''
          example: ''
          description: What happened - create/update/delete
    AuditTracker:
      type: object
      title: AuditTracker
      description: 'TBD: An external tracker receiving information from the system that can be subject to external auditing and verification of correct behavior. This is one of several notification/monitor/subscription patterns that may be more suitable for an encrypted Pub/Sub service.'
      x-not-in-database: false
      required:
        - id
        - name
        - publicKey
        - callbackAgreement
        - callbackConsentRecord
        - callbackPolicy
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        name:
          type: string
          format: ''
          example: ''
          description: Name of the auditing system
        publicKey:
          type: string
          format: ''
          example: ''
          description: The auditing system's public key for encrypting data sent to callback functions
        callbackAgreement:
          type: string
          format: ''
          example: ''
          description: A URL receiving a callback with the DataAgreement object + Revision + AuditEventType
        callbackConsentRecord:
          type: string
          format: ''
          example: ''
          description: A URL receiving a callback with the ConsentRecord object + Revision + AuditEventType
        callbackPolicy:
          type: string
          format: ''
          example: ''
          description: A URL receiving a callback with the Policy object + Revision + AuditEventType
        callbackRevisionTableHash:
          type: string
          format: ''
          example: ''
          description: 'A URL receiving a callback with <string> + AuditEventType. Periodically, the system can publish the hash of the revision table.'
        callbackSignatureTableHash:
          type: string
          format: ''
          example: ''
          description: 'A URL receiving a callback with <string> + AuditEventType. Periodically, the system can publish the hash of the signature table.'
    ConsentRecord:
      type: object
      title: ConsentRecord
      description: 'A consent record expresses consent (as defined in this building block''s specification) to a single DataAgreement. There must be a UNIQUE constraint on (data agreement revision, individual)'
      x-not-in-database: false
      required:
        - id
        - agreementRevisionHash
        - state
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: 'Objects may be passed back by some API endpoints without an id (PK), denoting that they are a "draft", i.e. a ConsentRecord that is not yet stored in the database and only exist in transit. Draft ConsentRecords do not have a Revision, but if paired up with a Signature, a valid Revision should be generated.'
        dataAgreementId:
          type: string
          x-fk-model: DataAgreement
          description: The DataAgreement to which consent has been given
        dataAgreementRevisionId:
          type: string
          x-fk-model: Revision
          description: The Revision of the data agreement which consent has been given to
        dataAgreementRevisionHash:
          type: string
          format: ''
          example: ''
          description: Copy of the revision hash. The hash is the included in the signature and ensures against tampering with the original agreement.
        individualId:
          type: string
          x-fk-model: Individual
          description: The Individual who has signed this consent record
        optIn:
          type: boolean
          format: ''
          example: ''
          description: 'True: The individual has positively opted in. False: The individual has explicitly said no (or withdrawn a previous consent).'
        state:
          type: string
          format: ''
          example: ''
          description: 'The state field is used to record state changes after-the-fact. It is maintained by the Consent BB itself. Valid states: unsigned/pending more signatures/signed'
          enum:
            - unsigned
            - signed
        signatureId:
          type: string
          x-fk-model: Signature
          description: 'A signature that hashes all the values of the consent record and has signed it with the key of the Invidiual, making it verifiable and tamper-proof. TBD: Relation to a Signature schema?'
    ConsentRecordFilter:
      type: object
      title: ConsentRecordFilter
      description: Query filter for API endpoint listing ConsentRecord objects
      x-not-in-database: true
      required:
        - optIn
      properties:
        optIn:
          type: boolean
          format: ''
          example: ''
          description: ''
        agreement:
          $ref: '#/components/schemas/DataAgreement'
          x-fk-model: DataAgreement
          description: ''
        agreementRevision:
          $ref: '#/components/schemas/Revision'
          x-fk-model: Revision
          description: ''
        individual:
          $ref: '#/components/schemas/Individual'
          x-fk-model: Individual
          description: ''
        functionalId:
          type: string
          format: ''
          example: ''
          description: ''
        foundationalId:
          type: string
          format: ''
          example: ''
          description: ''
    Controller:
      type: object
      title: Controller
      description: Details of a data controller.
      x-not-in-database: false
      required:
        - id
        - name
        - url
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        name:
          type: string
          format: ''
          example: ''
          description: Name of data controller (may be omitted if no data involved)
        url:
          type: string
          format: ''
          example: ''
          description: URL of data controller (may be omitted if no data involved)
    Individual:
      type: object
      title: Individual
      description: 'Shallowly models an Individual which may reference some instance in an external system (registration system, functional ID, foundational ID etc). An Individual instance of this model is not to be mistaken with a unique natural individual. It is up to the system owner to decide if this record permits mapping to a natural individual and/or if a single Individual row can map to several consent agreements.'
      x-not-in-database: false
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: The unique ID of an Individual row.
        externalId:
          type: string
          format: ''
          example: ''
          description: 'Reference to another foundational/functional ID, which is likely PII'
        externalIdType:
          type: string
          format: ''
          example: ''
          description: External id type specifier. A string. For instance "email" or "foundational id". Can be used in later queries.
        identityProviderId:
          type: string
          format: ''
          example: ''
          description: 'This could be an FK, but for now we do not have a mapping of identity providers. IDBB may have more requirements.'
    IndividualFilter:
      type: object
      title: IndividualFilter
      description: 'TBD: When creating an Invidiual, we need some input that refers to a functional or foundational ID in an external system'
      x-not-in-database: true
      properties:
        foundationalId:
          type: string
          format: ''
          example: ''
          description: ''
        functionalId:
          type: string
          format: ''
          example: ''
          description: ''
    Policy:
      type: object
      title: Policy
      description: A policy governs data and DataAgreement in the realm of an organisation that is refered to as "data controller" (GDPR) and owner of referencing Agreements.
      x-not-in-database: false
      required:
        - name
        - url
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: ''
        name:
          type: string
          format: ''
          example: ''
          description: Name of the policy
        version:
          type: string
          format: ''
          example: ''
          description: Version of the policy. It can follow semver format.
        url:
          type: string
          format: ''
          example: ''
          description: 'Permanent URL at which this very version of the Policy can be read, should not be allowed to change over time.'
        jurisdiction:
          type: string
          format: ''
          example: ''
          description: Jurisdiction
        industrySector:
          type: string
          format: ''
          example: ''
          description: Industry sector
        dataRetentionPeriodDays:
          type: integer
          format: ''
          example: ''
          description: Data retention period in days
        geographicRestriction:
          type: string
          format: ''
          example: ''
          description: Geographic restriction
        storageLocation:
          type: string
          format: ''
          example: ''
          description: Storage location
        thirdPartyDataSharing:
          type: bool
          format: ''
          example: ''
          description: Third party data sharing
    Revision:
      type: object
      title: Revision
      description: |-
        A *generic* revision model captures the serialized contents of any schema's single row. This is then subject to 1) cryptographic signature and 2) auditing.

        Aside from "successor" column, a revision should be considered locked.
      x-not-in-database: false
      required:
        - id
        - schemaName
        - objectId
        - objectData
        - serizalizedSnapshot
        - serializedHash
        - timestamp
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: Revision Id
        schemaName:
          type: string
          format: ''
          example: ''
          description: This was previously called "schema" but for technical reasons should be called "schemaName"
          enum:
            - dataAgreement
            - policy
            - dataAgreementRecord
        objectId:
          type: string
          format: ''
          example: ''
          description: The PK of the object that was serialized.
        objectData:
          type: string
          format: ''
          example: ''
          description: The object that is serialised.
        signedWithoutObjectId:
          type: boolean
          format: ''
          example: ''
          description: Indicates that objectId was left blank in serizalizedSnapshot when calculating serializedHash. objectId may be subsequently filled in.
        serizalizedSnapshot:
          type: string
          format: ''
          example: ''
          description: |
            Revisioned data (serialized as JSON) as a dict. Apply JSON Canonicalization Scheme as per IETF RFC 8785.  It contains all the fields of the schema except sucessorId, serializedHash, serializedSnapshot.
        serializedHash:
          type: string
          format: ''
          example: ''
          description: Hash of serizalizedSnapshot (SHA-1)
        timestamp:
          type: string
          format: ''
          example: ''
          description: Timestamp of when revisioning happened. It should be ISO 8601 UTC date time
        authorizedByIndividualId:
          description: Individual Id
          type: string
        authorizedByOtherId:
          type: string
          format: ''
          example: ''
          description: Reference to an admin user that has created this revision
        successorId:
          x-fk-model: Revision
          type: string
          description: 'If this revision is no longer the latest revision, refer to its successor.'
        predecessorHash:
          type: string
          format: ''
          example: ''
          description: 'Tamper-resistent artifact from previous record, copied from serializedHash'
        predecessorSignature:
          type: string
          format: ''
          example: ''
          description: Tamper-resistent artifact from previous record (we don't know if the previous record was signed or not)
    Signature:
      type: object
      title: Signature
      description: |
        A generic signature contains a cryptographic hash of some value,  together with a signature created by some private key in another system.  Required signing methods: Revision object or another Signature object.
      x-not-in-database: false
      required:
        - payload
        - signature
        - verificationMethod
        - verificationPayload
        - verificationPayloadHash
        - verificationSignedBy
        - timestamp
      properties:
        id:
          type: string
          format: ''
          example: ''
          description: 'Objects may be passed back by some API endpoints without an id (PK), denoting that they are a "draft", i.e. a Signature that is not yet stored in the database and only exist in transit.'
        payload:
          type: string
          format: ''
          example: ''
          description: 'The final payload that is signed, constructed as a JSON serialization of fields {verificationPayload: ..., verificationPayloadHash: ..., verificationMethod: ..., verificationArtifact: ..., verificationSignedBy: ..., verificationJwsHeader, timestamp: ..., signedWithoutObjectReference: ..., objectType: ..., objectReference: ...}. Serialized as a JSON dict. If the signature is generated before anything is stored in the database (and has a PK), then the objectReference should be omitted from the payload but filled in afterwards.'
        signature:
          type: string
          format: ''
          example: ''
          description: 'Signature of payload hash, the format of the signature should be specified by either verificationMethod or verificationJwsHeader'
        verificationMethod:
          type: string
          format: ''
          example: ''
          description: 'A well-known string denoting which method is used. Valid values: <TBD>. We might expand this with a relation to which verification methods that are supported. There may be a minimal set of supported methods necessary.'
        verificationPayload:
          type: string
          format: ''
          example: ''
          description: Internally generated serialized version of the data referenced by objectType and objectReference - by extracting and serializing their data as JSON.
        verificationPayloadHash:
          type: string
          format: ''
          example: ''
          description: 'Internally generated cryptographic hash of the value to be signed, i.e. the value of verificationPayload'
        verificationArtifact:
          type: string
          format: ''
          example: ''
          description: 'A verification artifact in the form of a scanned object, image, signature etc.'
        verificationSignedBy:
          type: string
          format: ''
          example: ''
          description: 'Because an identifier''s information may change over time, there is a need to store that information at the time of signing. In case of a cryptographic signature, this field should contain some identifier for looking up or verifying the public key of the signing party. In case of a non-cryptographic signature, this field could contain a natural individual''s names, personal number, email addresses - store a snapshot that binds to the signature at the time of signing. In case of a cryptographic signature, this may be the fingerprint of the individual''s public key or in some cases, a token from the user''s ID session.'
        verificationSignedAs:
          type: string
          format: ''
          example: ''
          description: 'DRAFT FIELD: Specifies the relationship between the authorizing signature and the invidual which the payload concerns. This is relevant for Consent Records. Possible values: "individual" / "delegate"'
        verificationJwsHeader:
          type: string
          format: ''
          example: ''
          description: 'Alternative to the verificationMethod, verificationHash and verificationSignature, give a JWS serialized object (RFC7515)'
        timestamp:
          type: string
          format: ''
          example: ''
          description: 'Timestamp of signature, currently this field isn''t part of the payload so it''s not tamper-proof.'
        signedWithoutObjectReference:
          type: boolean
          format: ''
          example: ''
          description: Indicates that objectReference was left blank in the serialized version that was signed.
        objectType:
          type: string
          format: ''
          example: ''
          description: 'Name of the schema model that objectReference points to. Values: "signature" or "revision"'
          enum:
            - revision
            - signature
        objectReference:
          type: string
          format: ''
          example: ''
          description: 'A symmetric relation / back reference to the objectType that was signed. We are currently just modelling signing another signature (a chain) or signing a Revision (which can be a revision of a consent record, an agreement, policy etc)'
    StatusReadiness:
      type: object
      description: This model is not stored in a database. It describes the status of the Building Block while running. Returns immediately. API should not be public.
      x-not-in-database: true
      required:
        - status
      properties:
        status:
          type: string
          format: ''
          example: ''
          description: 'Possible values: OK, WAITING, ERROR'
        errorMessage:
          type: string
          format: ''
          example: ''
          description: Description of failure
        waitingFor:
          type: string
          format: ''
          example: ''
          description: 'When a timeout occurs, a list of pending operations may be shared'
    StatusStartup:
      type: object
      title: StatusStartup
      description: 'This model is not stored in a database. It describes the status of the Building Block while starting up. API should not be public. This call is blocking until the system is ready, a timeout occurs or an error is detected.'
      x-not-in-database: true
      required:
        - status
      properties:
        status:
          type: string
          format: ''
          example: ''
          description: 'Possible values: OK, TIMEOUT, ERROR'
        errorMessage:
          type: string
          format: ''
          example: ''
          description: Description of failure
        waitingFor:
          type: string
          format: ''
          example: ''
          description: 'When a timeout occurs, a list of pending operations may be shared'
  securitySchemes:
    BearerAuth:
      bearerFormat: JWT
      description: Access token passed with Bearer prefix in Authorization header
      scheme: bearer
      type: http
info:
  contact:
    email: support@igrant.io
    name: iGrant.io
    url: 'https://igrant.io'
  description: 'The Consent Building Block enables services for individuals to approve the use  of their personal data by defining the principles, functions, and architecture  of an information system. For organisations that process personal data, it  provides the ability to know the individual''s will and legitimately process such  personal data. The Consent Building Block is a process-oriented GovStack Building Block  facilitating auditable bilateral data-agreements within a multi-agent environment that  integrates with most other Building Blocks.'
  license:
    name: Apache 2.0
    url: 'https://www.apache.org/licenses/LICENSE-2.0'
  title: Consent Building Block APIs
  version: 2023.11.1
openapi: 3.1.0
paths:
  /config/data-agreement:
    post:
      summary: CREATE - Create data agreement
      description: |
        This endpoint creates a data agreement for an organisation. 
        It also returns the latest revision of the created data agreement.
      operationId: configCreateAgreement
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              properties:
                dataAgreement:
                  $ref: '#/components/schemas/DataAgreement'
                  description: An object of type DataAgreement
              required:
                - dataAgreement
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreement:
                    $ref: '#/components/schemas/DataAgreement'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/data-agreement/{dataAgreementId}':
    get:
      summary: READ - Read data agreement
      description: |
        This endpoint allows the admin to view the latest data agreement defined
        earlier in an organisation. It also returns the latest revision number.
      operationId: configReadAgreement
      parameters:
        - description: Unique ID of an object
          in: path
          name: dataAgreementId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreement:
                    $ref: '#/components/schemas/DataAgreement'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    put:
      summary: UPDATE - Update data agreement
      description: This endpoint allows the admin to update the latest data agreement defined earlier in an organisation. It also returns the updated revision number.
      operationId: configUpdateAgreement
      parameters:
        - description: Unique ID of an object
          in: path
          name: dataAgreementId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              properties:
                dataAgreement:
                  $ref: '#/components/schemas/DataAgreement'
                  description: An object of type DataAgreement
              required:
                - dataAgreement
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreement:
                    $ref: '#/components/schemas/DataAgreement'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    delete:
      summary: DELETE - Delete data agreement
      description: This endpoint allows the admin to delete all revisions of a chosen data agreement defined earlier in an organisation.
      operationId: configDeleteAgreement
      parameters:
        - description: Unique ID of an object
          in: path
          name: dataAgreementId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/data-agreements:
    get:
      summary: LIST - List all data agreements
      description: This endpoint allows the admin to read all data agreements and their revisions defined earlier in an organisation.
      operationId: configListAgreement
      parameters:
        - description: An object with id revisionId
          in: query
          name: revisionId
          required: false
          schema:
            type: string
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - description: Filtering data agreements by draft/completed status
          in: query
          name: lifecycle
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreements:
                    items:
                      $ref: '#/components/schemas/DataAgreement'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/data-agreement/{dataAgreementId}/revisions':
    get:
      summary: LIST - List data agreement revisions
      description: This endpoint lists all revisions of a data agreement defined earlier in an organisation.
      operationId: configListAgreementRevisions
      parameters:
        - $ref: '#/paths/~1audit~1data-agreement~1%7BdataAgreementId%7D/get/parameters/0'
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreement:
                    $ref: '#/components/schemas/DataAgreement'
                  revisions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Revision'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
      x-specification-crudl-model: Revision
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: ''
  '/config/data-agreement/{dataAgreementId}/data-attributes':
    get:
      summary: READ - Read data attributes
      description: This endpoint reads all data attrinbutes defined in a data agreement.
      operationId: configListDataAttribute
      parameters:
        - $ref: '#/paths/~1audit~1data-agreement~1%7BdataAgreementId%7D/get/parameters/0'
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAttributes:
                    items:
                      allOf:
                        - $ref: '#/components/schemas/DataAgreement/properties/dataAttributes/items'
                        - type: object
                          properties:
                            dataAgreement:
                              $ref: '#/paths/~1config~1data-agreements~1data-attributes/get/responses/200/content/application~1json/schema/properties/dataAttributes/items/allOf/1/properties/dataAgreement'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/data-agreements/data-attribute/{dataAttributeId}':
    put:
      summary: UPDATE - Update data attribute
      description: 'This endpoint updates an existing data attribute defined in a data agreement. If updated, the associated data agreement revision is incremented automatically.'
      operationId: configUpdateDataAttribute
      parameters:
        - description: Unique ID of an object
          in: path
          name: dataAttributeId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              properties:
                dataAttribute:
                  $ref: '#/components/schemas/DataAgreement/properties/dataAttributes/items'
                  description: An object of type DataAttribute
              required:
                - dataAttribute
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAttribute:
                    $ref: '#/components/schemas/DataAgreement/properties/dataAttributes/items'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/data-agreements/data-attributes:
    get:
      summary: LIST - List all data attributes
      description: This endpoint reads all data attrinbutes defined in a data agreement with pagination.
      operationId: configListDataAttribute
      parameters:
        - $ref: '#/paths/~1config~1data-agreements/get/parameters/0'
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - description: null/data_source/data_using_service
          in: query
          name: methodOfUse
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAttributes:
                    items:
                      allOf:
                        - $ref: '#/components/schemas/DataAgreement/properties/dataAttributes/items'
                        - type: object
                          properties:
                            dataAgreement:
                              type: object
                              properties:
                                id:
                                  type: string
                                purpose:
                                  type: string
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/policy:
    post:
      summary: CREATE - Create data policy
      description: This endpoint creates a new data policy that can be reused as global parameter across all newly crearted data agremements.
      operationId: configCreatePolicy
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              properties:
                policy:
                  $ref: '#/components/schemas/Policy'
                  description: An object of type Policy
              required:
                - policy
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy:
                    $ref: '#/components/schemas/Policy'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: 'A set consisting of the new Policy object created, together with the initial Revision object.'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/policy/{policyId}':
    get:
      summary: READ - Read data policy
      description: READ - This endpoint reads a data policy with the latest revision info.
      operationId: configReadPolicy
      parameters:
        - description: Unique ID of an object
          in: path
          name: policyId
          required: true
          schema:
            type: string
        - description: An object with id revisionId
          in: query
          name: revisionId
          required: false
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy:
                    $ref: '#/components/schemas/Policy'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    put:
      summary: UPDATE - Update data policy
      description: This endpoint is used to update and existing data policy. It updates the existing and returns the updated version info. Updating a data policy does not affect existing data agreements.
      operationId: configUpdatePolicy
      parameters:
        - description: Unique ID of an object
          in: path
          name: policyId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              properties:
                policy:
                  $ref: '#/components/schemas/Policy'
                  description: An object of type Policy
              required:
                - policy
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy:
                    $ref: '#/components/schemas/Policy'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    delete:
      summary: DELETE - Delete data policy
      description: This endpoint is used to delete an existing data policy.
      operationId: configDeletePolicy
      parameters:
        - description: Unique ID of an object
          in: path
          name: policyId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/policies:
    get:
      summary: LIST - List all data policies
      description: This endpoint reads all data policies defined in the consent building block.
      operationId: configListPolicy
      parameters:
        - description: An object with id revisionId
          in: query
          name: revisionId
          required: false
          schema:
            type: string
        - description: Requested index for start of resources to be provided in response requested by client
          in: query
          name: offset
          required: false
          schema:
            type: integer
        - name: limit
          in: query
          description: Number of items returned per page. Requested number of resources to be provided in response requested by client
          required: false
          schema:
            type: integer
            default: 10
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  policies:
                    items:
                      $ref: '#/components/schemas/Policy'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: A list of Policy objects readable for the current session's credentials.
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/policy/{policyId}/revisions':
    get:
      summary: LIST - List data policy revisions
      description: This endpoint reads all data policy revisions defined in the consent building block.
      operationId: configListPolicyRevisions
      parameters:
        - description: Unique ID of an object
          in: path
          name: policyId
          required: true
          schema:
            type: string
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy:
                    $ref: '#/components/schemas/Policy'
                  revisions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Revision'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/individual:
    post:
      summary: CREATE - Create individual
      description: This endpoint creates an individual for an organisation in the consent building block. This is used to onboard existing or new users.
      operationId: configCreatePolicy
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                    description: An object of type Individual
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                individual:
                  allOf:
                    - $ref: '#/components/schemas/Individual'
                    - type: object
                      title: IndividualExtras
                      required:
                        - name
                        - email
                        - phone
                      properties:
                        name:
                          type: string
                          description: Name of the individual
                        iamId:
                          type: string
                          description: Create a user in keycloak and save the `id` as `iamId`
                        email:
                          type: string
                          description: Email Id
                        phone:
                          type: string
                          description: Phone
                  description: An object of type Individual
              required:
                - individual
      tags:
        - config
  '/config/individual/{individualId}':
    get:
      summary: READ - Read individual
      description: This endpoint is used to read an individual info defined for an organisation in the consent building block.
      operationId: configReadIndividual
      parameters:
        - in: path
          name: individualId
          description: Unique ID of an object
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    put:
      summary: UPDATE - Update individual
      description: This endpoint is used to udpated an individual for an organisation defined in the consent building block.
      operationId: configUpdateIndividual
      parameters:
        - in: path
          name: individualId
          description: Unique ID of an object
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                individual:
                  allOf:
                    - $ref: '#/components/schemas/Individual'
                    - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                  description: An object of type Individual
              required:
                - individual
      tags:
        - config
  /config/individuals:
    get:
      summary: LIST - List all individuals
      description: This endpoint is used to list all individuals in the organisation defined in the consent building block.
      operationId: configListIndividuals
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individuals:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/Individual'
                        - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/individual/upload:
    post:
      summary: CREATE - Create individual(s) via csv
      description: This endpoint is used to onboard existing individual users defined in the organisation to consent building block using a .csv file.
      operationId: configUploadIndividuals
      requestBody:
        content:
          multipart/form-data:
            encoding: {}
            schema:
              properties:
                individuals:
                  format: binary
                  type: string
              required:
                - individuals
              type: object
        required: false
      responses:
        '200':
          content: {}
      security:
        - BearerAuth: []
      deprecated: false
      tags:
        - config
  /config/webhook:
    post:
      summary: CREATE - Create webhook
      description: This endpoint is used to create a webhook to trigger events from consent building block to an external IT system.
      operationId: configCreateWebhook
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                webhook:
                  $ref: '#/components/schemas/Webhook'
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  webhook:
                    $ref: '#/components/schemas/Webhook'
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/webhook/{webhookId}':
    get:
      summary: READ - Read webhook
      description: This endpoint is used to read a webhook to by its ID defined in the consent building block.
      operationId: configReadWebhook
      parameters:
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  webhook:
                    $ref: '#/components/schemas/Webhook'
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
    put:
      summary: UPDATE - Update webhook
      description: This endpoint is used to update an existing webhook to trigger events from consent building block to an external IT system.
      operationId: configUpdateWebhook
      parameters:
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                webhook:
                  $ref: '#/components/schemas/Webhook'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  webhook:
                    $ref: '#/components/schemas/Webhook'
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
    delete:
      summary: DELETE - Delete webhook
      description: This endpoint is used to delete an existing webhook that was defined to trigger events from the consent building block to an external IT system.
      operationId: configDeleteWebhook
      parameters:
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  webhook:
                    $ref: '#/components/schemas/Webhook'
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  /config/webhooks:
    get:
      summary: LIST - List all webhooks
      description: This endpoint is used to get all webhooks that was defined to trigger events from the consent building block to an external IT system.
      operationId: configListWebhooks
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  webhooks:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/Webhook'
                      description: Webhook
                  pagination:
                    $ref: '#/components/schemas/Pagination'
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/webhook/{webhookId}/ping':
    post:
      summary: Ping webhook
      description: This endpoint is used to ping a webhook that was defined to trigger events from the consent building block to an external IT system.
      operationId: configPingWebhook
      parameters:
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  webhookPing:
                    type: object
                    title: WebhookPing
                    required:
                      - responseStatusCode
                      - responseStatusStr
                      - executionStartTimeStamp
                      - executionEndTimeStamp
                      - status
                      - statusDescription
                    properties:
                      responseStatusCode:
                        type: integer
                        format: int32
                        description: Response status code
                      responseStatusStr:
                        type: string
                        description: Response status string
                      executionStartTimestamp:
                        type: string
                        description: Execution start timestamp
                      executionEndTimestamp:
                        type: string
                        description: Execution end timestamp
                      status:
                        type: string
                        description: Status of webhook
                      statusDescription:
                        type: string
                        description: Status description
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/webhooks/{webhookId}/deliveries':
    get:
      summary: LIST - List all webhook deliveries
      description: This endpoint is used to read recent webhook deliveries with pagination from the consent building block that were sent to an external IT system.
      operationId: configListAllRecentWebhookDeliveries
      parameters:
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                required:
                  - webhookDeliveries
                  - pagination
                type: object
                properties:
                  webhookDeliveries:
                    type: array
                    items:
                      oneOf:
                        - type: object
                          title: WebhookDelivery
                          properties:
                            id:
                              type: string
                              description: Webhook delivery Id
                            webhookId:
                              type: string
                              description: Webhook Id
                            responseStatusCode:
                              type: integer
                              format: int32
                              description: Response status code
                            responseStatusStr:
                              type: string
                              description: Response status string
                            timestamp:
                              type: string
                              description: Response timestamp
                            status:
                              type: string
                              description: Webhook delivery status
                            statusDescription:
                              type: string
                              description: Webhook delivery status description
                    description: WebhookDelivery
                  pagination:
                    $ref: '#/components/schemas/Pagination'
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/webhooks/{webhookId}/delivery/{deliveryId}':
    get:
      summary: READ - Read webhook delivery
      description: This endpint is used to get the recent webhook deliveries for a webhook defined in the consent building block.
      operationId: configReadRecentWebhookDelivery
      parameters:
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
        - name: deliveryId
          in: path
          required: true
          style: simple
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                required:
                  - webhookDelivery
                type: object
                properties:
                  webhookDelivery:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/paths/~1config~1webhooks~1%7BwebhookId%7D~1deliveries/get/responses/200/content/application~1json/schema/properties/webhookDeliveries/items/oneOf/0'
                    description: WebhookDelivery
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/webhooks/{webhookId}/delivery/{deliveryId}/redeliver':
    post:
      summary: Re-deliver a webhook event
      description: This endpoint is used to re-deliver a webhook payload by delivery ID.
      operationId: configRedeliverWebhook
      parameters:
        - name: organizationId
          in: path
          required: true
          style: simple
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          style: simple
          schema:
            type: string
        - name: deliveryId
          in: path
          required: true
          style: simple
          schema:
            type: string
      responses:
        '204':
          description: OK
          content: {}
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  /config/webhooks/event-types:
    get:
      summary: READ - Read webhook event types
      description: This endpoint is used to list all webhook event types defined in the consent building block.
      operationId: configReadWebhookEventTypes
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                required:
                  - eventTypes
                type: object
                properties:
                  eventTypes:
                    type: array
                    items:
                      type: string
                      title: WebhookEventType
                      enum:
                        - data.update.initiated
                        - data.update.cancelled
                        - consent.allowed
                        - consent.disallowed
                        - consent.auto_expiry
                        - org.unsubscribed
                        - data.delete.initiated
                        - data.download.initiated
                        - data.delete.cancelled
                        - data.download.cancelled
                        - org.subscribed
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  /config/webhooks/payload/content-types:
    get:
      summary: LIST - List all webhook content types
      description: This endpoint is used to get webhook content types.
      operationId: getWebhookPayloadContentTypes.yaml
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                required:
                  - ContentTypes
                type: object
                properties:
                  ContentTypes:
                    type: array
                    items:
                      type: string
                      enum:
                        - application/json
                        - application/x-www-form-urlencoded
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  /config/idp/open-id:
    post:
      summary: CREATE - Create IDP
      description: This endpoint is used to configure an IdP (e.g. OIDC based) used by the organisation in the consent building block.
      operationId: configCreateIdp
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              properties:
                idp:
                  $ref: '#/paths/~1config~1idp~1open-id~1%7BidpId%7D/delete/responses/200/content/application~1json/schema'
                  description: An object of type IDP
              required:
                - idp
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  idp:
                    $ref: '#/paths/~1config~1idp~1open-id~1%7BidpId%7D/delete/responses/200/content/application~1json/schema'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/idp/open-id/{idpId}':
    get:
      summary: READ - Read IdP details
      description: This endpoint is used to read the IdP details configured by the organisation in the consent building block.
      operationId: configReadIdp
      parameters:
        - $ref: '#/paths/~1service~1idp~1open-id/get/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  idp:
                    $ref: '#/paths/~1config~1idp~1open-id~1%7BidpId%7D/delete/responses/200/content/application~1json/schema'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    put:
      summary: UPDATE - Update IDP
      description: UPDATE - Update an IDP
      operationId: configUpdatePolicy
      parameters:
        - $ref: '#/paths/~1service~1idp~1open-id/get/parameters/0'
      requestBody:
        content:
          application/json:
            schema:
              properties:
                idp:
                  $ref: '#/paths/~1config~1idp~1open-id~1%7BidpId%7D/delete/responses/200/content/application~1json/schema'
                  description: An object of type IDP
              required:
                - idp
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  idp:
                    $ref: '#/paths/~1config~1idp~1open-id~1%7BidpId%7D/delete/responses/200/content/application~1json/schema'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
      x-specification-crudl-model: IDP
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: ''
      x-specification-usecase: UC-C-PIC-A-002
    delete:
      description: DELETE - Delete an IDP
      operationId: configDeleteIdp
      parameters:
        - $ref: '#/paths/~1service~1idp~1open-id/get/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                title: IDP
                description: Identity Provider
                x-not-in-database: false
                required:
                  - id
                  - authorisationUrl
                  - tokenUrl
                  - userInfoUrl
                  - jwksUrl
                  - clientId
                  - clientSecret
                  - defaultScope
                properties:
                  id:
                    type: string
                    format: ''
                    example: ''
                    description: IDP Id
                  authorisationUrl:
                    type: string
                    description: Authorisation Url
                  tokenUrl:
                    type: string
                    description: Token Url
                  issuerUrl:
                    type: string
                    description: Issuer Url
                  logoutUrl:
                    type: string
                    description: Logout Url
                  userInfoUrl:
                    type: string
                    description: User info Url
                  jwksUrl:
                    type: string
                    description: JWKS Url
                  clientId:
                    type: string
                    description: Client Id
                  clientSecret:
                    type: string
                    description: Client secret
                  defaultScope:
                    type: string
                    description: Default scope
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      summary: DELETE - Delete an IDP
      tags:
        - config
      x-specification-crudl-model: IDP
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: ''
      x-specification-usecase: UC-C-PIC-A-004
  /config/idp/open-ids:
    post:
      summary: LIST - List all IdPs
      description: This endpoint read all IdPs configured for the organisation in the consent building block.
      operationId: configListIdp
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  idps:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/paths/~1config~1idp~1open-id~1%7BidpId%7D/delete/responses/200/content/application~1json/schema'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/admin/apikeys:
    get:
      summary: LIST - List all api keys
      description: This endpoint lists all API keys created in consent building block with pagination.
      operationId: configListApiKey
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  apiKeys:
                    items:
                      allOf:
                        - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/0'
                        - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/1'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  /config/admin/apikey:
    post:
      summary: CREATE - Create API key
      description: 'This endpoint is used to create an API key for accessing endpoints in the consent building block. It can created for a specific scope. E.g. Config, Onboard, Audit, Service.'
      operationId: configCreateApikey
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              properties:
                apiKey:
                  $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/0'
                  description: An object of type APIKey
              required:
                - apiKey
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  apiKey:
                    allOf:
                      - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/0'
                      - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/1'
                required:
                  - apiKey
                type: object
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
  '/config/admin/apikey/{apiKeyId}':
    put:
      summary: UPDATE - Update API key
      description: 'This endpoint is used to update an existing API key for accessing endpoints in the consent building block. It can be updated for a specific scope. E.g. Config, Onboard, Audit, Service.'
      operationId: configUpdateApiKey
      parameters:
        - description: Unique ID of an object
          in: path
          name: apiKeyId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              properties:
                apiKey:
                  $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/0'
                  description: An object of type APIKey
              required:
                - apiKey
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  apiKey:
                    allOf:
                      - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/0'
                      - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/delete/responses/200/content/application~1json/schema/allOf/1'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
    delete:
      summary: DELETE - Delete API key
      description: This endpoint is used to delete an existing API key for  accessing endpoints in the consent building block.
      operationId: configDeletePolicy
      parameters:
        - $ref: '#/paths/~1config~1admin~1apikey~1%7BapiKeyId%7D/put/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    title: ApiKey
                    description: Api key
                    x-not-in-database: false
                    required:
                      - scopes
                    properties:
                      id:
                        type: string
                        format: ''
                        example: ''
                        description: API key Id
                      name:
                        type: string
                        format: ''
                        example: ''
                        description: API key name
                      scopes:
                        type: array
                        items:
                          type: string
                          enum:
                            - config
                            - audit
                            - service
                            - onboard
                        description: Scopes for API key
                      apiKey:
                        type: string
                        format: ''
                        example: ''
                        description: API key
                      expiryInDays:
                        type: integer
                        format: ''
                        default: 30
                        description: 'Expiry in days. If expiry is 0, then default to 30 days'
                  - type: object
                    title: ApiKeyExtras
                    properties:
                      expiryTimestamp:
                        type: string
                      timestamp:
                        type: string
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - config
      x-specification-crudl-model: ApiK
  /config/privacy-dashboard:
    get:
      summary: GET - Read privacy dashboard
      description: This endpoint is used to read the deployed privacy board for the organiastion as per the data agreement defined in the consent building block.
      operationId: readPrivacyDashboard
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  hostname:
                    type: string
                  version:
                    type: string
                  state:
                    type: int
                    enum:
                      - 0
                      - 1
                      - 2
                  stateStr:
                    type: string
                    enum:
                      - Not Configured
                      - Requested
                      - Deployed
                required:
                  - privacydashboard
                type: object
          description: OK
      deprecated: false
      security:
        - BearerAuth: []
      tags:
        - config
  /onboard/admin:
    put:
      description: UPDATE - Update organisation admin
      operationId: onboardUpdateAdmin
      requestBody:
        content:
          application/json:
            schema:
              properties:
                organisationAdmin:
                  $ref: '#/paths/~1onboard~1admin/put/responses/200/content/application~1json/schema/properties/organisationAdmin'
                  description: An object of type OrganisationAdmin
              required:
                - organisationAdmin
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  organisationAdmin:
                    type: object
                    title: OrganisationAdmin
                    x-not-in-database: false
                    required:
                      - name
                    properties:
                      id:
                        type: string
                        format: ''
                        example: ''
                        description: ''
                      email:
                        type: string
                        description: Email
                      name:
                        type: string
                        description: Name
                      avatarImageId:
                        type: string
                        description: Avatar image Id
                      avatarImageUrl:
                        type: string
                        description: Avatar image Url
                      lastVisited:
                        type: string
                        description: Last visited date time
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      summary: UPDATE - Update organisation admin
      tags:
        - onboard
      x-specification-crudl-model: OrganisationAdmin
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: ''
      x-specification-usecase: UC-C-PIC-A-002
    get:
      deprecated: false
      description: READ - Read organisation admin
      operationId: onboardGetAdmin
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  organisationAdmin:
                    $ref: '#/paths/~1onboard~1admin/put/responses/200/content/application~1json/schema/properties/organisationAdmin'
                type: object
          description: OK
      security:
        - BearerAuth: []
      tags:
        - onboard
  /onboard/admin/avatarimage:
    put:
      deprecated: false
      description: UPDATE - Update organisation admin avatar image
      summary: UPDATE - Update organisation admin avatar image
      operationId: onboardUpdateAdminAvatar
      requestBody:
        content:
          multipart/form-data:
            encoding: {}
            schema:
              properties:
                avatarimage:
                  format: binary
                  type: string
              required:
                - avatarimage
              type: object
        required: false
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  organisationAdmin:
                    $ref: '#/paths/~1onboard~1admin/put/responses/200/content/application~1json/schema/properties/organisationAdmin'
                type: object
          description: OK
      security:
        - BearerAuth: []
      tags:
        - onboard
    get:
      deprecated: false
      description: READ - Read organisation admin avatar image
      operationId: onboardGetAdminAvatar
      responses:
        '200':
          headers: {}
      security:
        - BearerAuth: []
      tags:
        - onboard
  /onboard/password/reset:
    put:
      tags:
        - onboard
      description: UPDATE - Reset Password
      operationId: onboardResetPassword
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              required:
                - currentPassword
                - newPassword
              type: object
              properties:
                currentPassword:
                  type: string
                newPassword:
                  type: string
        required: true
      responses:
        '200':
          description: OK
          content: {}
      deprecated: false
      security:
        - BearerAuth: []
  /onboard/password/forgot:
    put:
      tags:
        - onboard
      description: UPDATE - Forgot Password
      operationId: onboardForgotPassword
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              required:
                - username
              type: object
              properties:
                username:
                  type: string
        required: true
      responses:
        '200':
          content: {}
      deprecated: false
  /onboard/admin/login:
    post:
      tags:
        - onboard
      description: Login organisation admin
      operationId: loginOrganisationAdmin
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              required:
                - username
                - password
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                required:
                  - accessToken
                  - expiresIn
                  - refreshExpiresIn
                  - refreshToken
                  - tokenType
                type: object
                title: Token
                properties:
                  accessToken:
                    type: string
                  expiresIn:
                    type: integer
                    format: int32
                  refreshExpiresIn:
                    type: integer
                    format: int32
                  refreshToken:
                    type: string
                  tokenType:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                required:
                  - errorCode
                  - errorDescription
                type: object
                properties:
                  errorCode:
                    type: int
                  errorDescription:
                    type: string
      deprecated: false
  /onboard/individual/login:
    post:
      tags:
        - onboard
      description: Login individual
      operationId: loginIndividual
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              required:
                - username
                - password
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                required:
                  - individual
                  - token
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                  token:
                    $ref: '#/paths/~1onboard~1admin~1login/post/responses/200/content/application~1json/schema'
      deprecated: false
  /onboard/logout:
    post:
      tags:
        - onboard
      description: Logout
      operationId: logout
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              required:
                - refreshToken
              type: object
              properties:
                refreshToken:
                  type: string
        required: true
      responses:
        '200':
          description: OK
      deprecated: false
  /onboard/organisation:
    get:
      deprecated: false
      description: Get organization
      operationId: getOrganisation
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  organisation:
                    required:
                      - name
                      - location
                      - description
                      - policyUrl
                    type: object
                    properties:
                      id:
                        type: string
                        description: Organisation Id
                      name:
                        type: string
                        description: Name of the organisation
                      description:
                        type: string
                        description: Overview for the organisation
                      sector:
                        type: string
                        description: Sector
                      location:
                        type: string
                        description: Location
                      policyUrl:
                        type: string
                        description: Policy Url
                required:
                  - organisation
                type: object
          description: OK
      security:
        - BearerAuth: []
      tags:
        - onboard
    put:
      deprecated: false
      description: Update organization
      operationId: updateOrganisation
      requestBody:
        content:
          application/json:
            schema:
              properties:
                description:
                  type: string
                location:
                  type: string
                name:
                  type: string
                policyUrl:
                  type: string
              required:
                - name
                - location
                - description
                - policyUrl
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  organisation:
                    $ref: '#/paths/~1onboard~1organisation/get/responses/200/content/application~1json/schema/properties/organisation'
                required:
                  - organisation
                type: object
          description: Updated the organisation
      security:
        - BearerAuth: []
      tags:
        - onboard
  /onboard/organisation/coverimage:
    get:
      deprecated: false
      description: Get organization cover image
      operationId: getOrganisationCoverImage
      responses:
        '200':
          headers: {}
      security:
        - BearerAuth: []
      tags:
        - onboard
    post:
      deprecated: false
      description: Update organization cover image
      operationId: updateOrganisationCoverImage
      requestBody:
        content:
          multipart/form-data:
            encoding: {}
            schema:
              properties:
                orgimage:
                  format: binary
                  type: string
              required:
                - orgimage
              type: object
        required: false
      responses:
        '200':
          description: OK
      security:
        - BearerAuth: []
      tags:
        - onboard
  /onboard/organisation/logoimage:
    get:
      deprecated: false
      description: Get organization logo image
      operationId: getOrganisationLogoImage
      responses:
        '200':
          headers: {}
      security:
        - BearerAuth: []
      tags:
        - onboard
    post:
      deprecated: false
      description: Update organization logo image
      operationId: updateOrganisationLogoImage
      requestBody:
        content:
          multipart/form-data:
            encoding: {}
            schema:
              properties:
                orgimage:
                  format: binary
                  type: string
              required:
                - orgimage
              type: object
        required: false
      responses:
        '200':
          description: OK
      security:
        - BearerAuth: []
      tags:
        - onboard
  /onboard/token/refresh:
    post:
      deprecated: false
      description: Refresh access token
      operationId: refreshToken
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              properties:
                clientId:
                  type: string
                refreshToken:
                  type: string
              required:
                - refreshToken
                - clientId
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/paths/~1onboard~1admin~1login/post/responses/200/content/application~1json/schema'
          description: OK
      security: []
      tags:
        - onboard
  /onboard/token/exchange:
    post:
      deprecated: false
      description: Exchange authorisation code for access token
      operationId: exchangeCodeForToken
      parameters:
        - description: Unique ID of an object
          in: query
          name: authorisationCode
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              properties:
                redirectUri:
                  type: string
                  description: Redirect URI as configured in OIDC client
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  userInfo:
                    required:
                      - subject
                    type: object
                    title: Token
                    properties:
                      subject:
                        type: string
                      profile:
                        type: string
                      email:
                        type: string
                      emailVerified:
                        type: boolean
                  token:
                    $ref: '#/paths/~1onboard~1admin~1login/post/responses/200/content/application~1json/schema'
          description: OK
      security: []
      tags:
        - onboard
  /onboard/status:
    get:
      deprecated: false
      description: READ - Read status
      operationId: onboardReadStatus
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  applicationMode:
                    type: string
                  version:
                    type: string
                  candidate:
                    type: string
                  revision:
                    type: string
          description: OK
      security:
        - BearerAuth: []
      tags:
        - onboard
  /service/organisation/coverimage:
    get:
      summary: READ - Read organisation cover image
      description: This endpoint is used to retrieve the existing cover image for the organisation. The cover image is used to display in the privacy dashboard.
      operationId: serviceReadOrganisationCoverImage
      responses:
        '200':
          headers: {}
      security:
        - BearerAuth: []
      deprecated: false
      tags:
        - service
  /service/organisation/logoimage:
    get:
      summary: READ - Read organisation logo image
      description: Read organisation logo image This endpoint is used to retrieve the existing logo image for the organisation. The logo image is used to display in the privacy dashboard as well in data sharing UIs.
      operationId: serviceReadOrganisationLogoImage
      deprecated: false
      responses:
        '200':
          headers: {}
      security:
        - BearerAuth: []
      tags:
        - service
  /service/idp/open-id:
    get:
      summary: READ - Read IdP details
      description: This endpoint is used to read the IdP details configured by the organisation in the consent building block.
      operationId: serviceReadIdp
      parameters:
        - description: Unique ID of an object
          in: path
          name: idpId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  idp:
                    type: object
                    x-not-in-database: false
                    required:
                      - id
                      - logoutUrl
                      - clientId
                    properties:
                      id:
                        type: string
                        format: ''
                        example: ''
                        description: IDP Id
                      logoutUrl:
                        type: string
                        description: Logout Url
                      clientId:
                        type: string
                        description: Client Id
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  /service/organisation:
    get:
      summary: READ - Read organisation
      description: 'This endpoint is used to read the organisation information as configured by the organisation in the consent building block. This is used, for e.g., in the privacy dashboard.'
      operationId: serviceReadOrganisation
      deprecated: false
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  organisation:
                    items:
                      allOf:
                        - $ref: '#/paths/~1onboard~1organisation/get/responses/200/content/application~1json/schema/properties/organisation'
                        - type: object
                          title: OrganisationExtras
                          properties:
                            coverImageId:
                              type: string
                              description: Cover image id
                            coverImageUrl:
                              type: string
                              description: Cover image url
                            logoImageId:
                              type: string
                              description: Logo image id
                            logoImageUrl:
                              type: string
                              description: Logo image url
                required:
                  - organisation
                type: object
          description: OK
      security:
        - BearerAuth: []
      tags:
        - service
  /service/data-agreements:
    get:
      summary: LIST - List all active data agreements
      description: This endpoint is used to list all active data agreements by the organisation in consent building block. The results are returned with pagination.
      operationId: serviceAgreementList
      parameters:
        - $ref: '#/paths/~1config~1data-agreements/get/parameters/0'
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreements:
                    items:
                      $ref: '#/components/schemas/DataAgreement'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/data-agreement/{dataAgreementId}':
    get:
      summary: READ - Read data agreement
      description: This endpoint is used to read the data agreement defined by the organisation in consent building block.
      operationId: serviceAgreementRead
      parameters:
        - description: Unique ID of an object
          in: path
          name: dataAgreementId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    dataAgreement:
                      $ref: '#/components/schemas/DataAgreement'
                    revision:
                      $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/data-agreement/{dataAgreementId}/data-attributes':
    get:
      summary: LIST - List data attributes
      description: This endpoint is used to read the data attributes defined in a particular data agreement revision.
      operationId: serviceAgreementDataRead
      parameters:
        - $ref: '#/paths/~1audit~1data-agreement~1%7BdataAgreementId%7D/get/parameters/0'
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - $ref: '#/paths/~1config~1data-agreements/get/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAttributes:
                    items:
                      $ref: '#/components/schemas/DataAgreement/properties/dataAttributes/items'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/policy/{policyId}':
    get:
      summary: READ - Read data policy
      description: This endpoint is used to read latest version of data policy defined in the organisation in the consent building block.
      operationId: servicePolicyRead
      parameters:
        - description: Unique ID of an object
          in: path
          name: policyId
          required: true
          schema:
            type: string
        - $ref: '#/paths/~1config~1data-agreements/get/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy:
                    $ref: '#/components/schemas/Policy'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
      x-specification-crudl-model: Policy
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: ''
      x-specification-usecase: UC-C-PIC-A-003
  /service/verification/data-agreements:
    get:
      summary: LIST - List all consent records
      description: This endpoint is used to list all consent records available for an organisation defined in the consent building block. The results are paginated.
      operationId: serviceVerificationAgreementList
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecords:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConsentRecord'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
      x-specification-crudl-model: ''
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: '1.1'
      x-specification-usecase: UC-C-PIC-A-003
  '/service/verification/consent-record/{consentRecordId}':
    get:
      summary: READ - Read latest consent record
      description: This endpoint is used to read the latest consent record for an organisation in the consent building block.
      operationId: serviceVerificationAgreementConsentRecordRead
      parameters:
        - $ref: '#/paths/~1audit~1consent-record~1%7BconsentRecordId%7D/get/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
      x-specification-crudl-model: ''
      x-specification-pii-or-sensitive: 'False'
      x-specification-scenario: '1.2'
      x-specification-usecase: UC-C-PIC-A-003
  /service/verification/consent-records:
    get:
      summary: LIST - List all consent records
      description: This endpoint is used to list all consent records available for an organisation defined in the consent building block. The results are paginated.
      operationId: serviceVerificationConsentRecordList
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecords:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConsentRecord'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
      x-specification-crudl-model: ''
      x-specification-pii-or-sensitive: 'True'
      x-specification-scenario: '3.1, 1.2'
      x-specification-usecase: UC-C-PIC-A-003
  '/service/individual/record/data-agreement/{dataAgreementId}':
    post:
      summary: CREATE - Create consent record
      description: This endpoint is used to create a consent record when an individial records their consent (e.g. in the privacy dashboard) against a data agreement.
      operationId: serviceCreateIndividualConsentRecord
      parameters:
        - $ref: '#/paths/~1audit~1data-agreement~1%7BdataAgreementId%7D/get/parameters/0'
        - $ref: '#/paths/~1config~1data-agreements/get/parameters/0'
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
    get:
      summary: READ - Read consent record
      description: This endpoint is used to read a consent record for an individial for a chosen data agreement. There should be one unambiguous consent record for an individual.
      operationId: serviceReadIndividualRecordRead
      parameters:
        - $ref: '#/paths/~1audit~1data-agreement~1%7BdataAgreementId%7D/get/parameters/0'
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  /service/individual/record/consent-record/draft:
    post:
      summary: CREATE - Create draft consent record
      description: This endpoint is used to create a draft (unsaved) consent record and signature object (without a PKI) for a data agreement.
      operationId: serviceCreateIndividualConsentRecordDraft
      parameters:
        - description: An object with id individualId
          in: query
          name: individualId
          required: true
          schema:
            type: string
        - description: An object with id dataAgreementId
          in: query
          name: dataAgreementId
          required: true
          schema:
            type: string
        - description: An object with id revisionId
          in: query
          name: revisionId
          required: false
          schema:
            type: string
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
                  signature:
                    $ref: '#/components/schemas/Signature'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  /service/individual/record/consent-record:
    post:
      summary: CREATE - Create consent record and signature
      description: This endpoint is used to create a consent record and signature object. This returns the same objects with the PK defined.
      operationId: serviceCreateIndividualConsentRecordAndSignature
      parameters:
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      requestBody:
        content:
          application/json:
            schema:
              properties:
                consentRecord:
                  $ref: '#/components/schemas/ConsentRecord'
                  description: An object of type DataAgreementRecord
                signature:
                  $ref: '#/components/schemas/Signature'
                  description: An object of type Signature
              required:
                - consentRecord
                - signature
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
                  revision:
                    $ref: '#/components/schemas/Revision'
                  signature:
                    $ref: '#/components/schemas/Signature'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
      x-specification-crudl-model: ''
      x-specification-pii-or-sensitive: 'True'
      x-specification-scenario: '1.2'
      x-specification-usecase: UC-C-PIC-I-002
    get:
      summary: LIST - List all consent records for individual
      description: This endpoint is used to list all consent records for an individual belonging to an organiation defined in the consent building block.
      operationId: serviceListIndividualConsentRecordList
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecords:
                    items:
                      $ref: '#/components/schemas/ConsentRecord'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
      x-specification-crudl-model: ''
      x-specification-pii-or-sensitive: 'True'
      x-specification-scenario: ''
      x-specification-usecase: UC-C-PIC-I-001
  /service/individual/record:
    delete:
      summary: DELETE - Delete all consent records
      description: 'This endpoint is used to delete all consent records for an individual belonging to an organiation defined in the consent building block. This could be used, for example to exercise digital rights (Right to be forgotten) and deletes all consent records that shall not be retained and have a "forgettable" data agreement. This may also delete an unsigned consent record, for instance in cases where the user exits the signing process.'
      operationId: serviceDeleteAllRecords
      parameters:
        - in: header
          name: X-ConsentBB-IndividualId
          required: true
          schema:
            type: string
          description: Individual Id
      responses:
        '200':
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/individual/record/consent-record/{consentRecordId}':
    put:
      summary: UPDATE - Update consent record
      description: This endpoint is used to update an existing consent record for a given data agreement for an organiation defined in the consent building block. Note that updating a signed consent record invalidates its earlier signature.
      operationId: serviceUpdateIndividualConsentRecord
      parameters:
        - $ref: '#/paths/~1audit~1consent-record~1%7BconsentRecordId%7D/get/parameters/0'
        - description: An object with id individualId
          in: query
          name: individualId
          required: true
          schema:
            type: string
        - description: An object with id dataAgreementId
          in: query
          name: dataAgreementId
          required: true
          schema:
            type: string
        - description: An object with id revisionId
          in: query
          name: revisionId
          required: false
          schema:
            type: string
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      requestBody:
        content:
          application/json:
            schema:
              properties:
                optIn:
                  type: boolean
                  format: ''
                  example: ''
                  description: 'True: The individual has positively opted in. False: The individual has explicitly said no (or withdrawn a previous consent).'
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
                  revision:
                    $ref: '#/components/schemas/Revision'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/individual/record/consent-record/{consentRecordId}/signature':
    post:
      summary: CREATE - Creates blank signature
      description: This endpoint is used to create a blank signature object for the consent record for an individual in an organiation defined in the consent building block. CREATE - Creates and returns a blank Signature object for the consent record.
      operationId: serviceCreateIndividualConsentRecordSignature
      parameters:
        - description: Unique ID of an object
          in: path
          name: consentRecordId
          required: true
          schema:
            type: string
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  signature:
                    $ref: '#/components/schemas/Signature'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
    put:
      summary: UPDATE - Updates signature for consent record
      description: This endpoint is used to update a signature object for the consent record for an individual in an organiation defined in the consent building block.
      operationId: serviceUpdateIndividualConsentRecordSignature
      parameters:
        - description: Unique ID of an object
          in: path
          name: consentRecordId
          required: true
          schema:
            type: string
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      requestBody:
        content:
          application/json:
            schema:
              properties:
                signature:
                  $ref: '#/components/schemas/Signature'
                  description: An object of type Signature
              required:
                - signature
              type: object
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  signature:
                    $ref: '#/components/schemas/Signature'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/individual/record/data-agreement/{dataAgreementId}/all':
    get:
      summary: LIST - List all consent records
      description: This endpoint is used to list all consent records existing for a data agreement for an organisation defined in the consent building block. The response is paginated.
      operationId: serviceListIndividualAgreementConsentRecordList
      parameters:
        - $ref: '#/paths/~1audit~1data-agreement~1%7BdataAgreementId%7D/get/parameters/0'
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecords:
                    items:
                      $ref: '#/components/schemas/ConsentRecord'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  /service/individual/record/consent-record/history:
    get:
      summary: LIST - List consent record history
      description: This endpoint is used to list all consent record history existing for an individual in an organisation defined in the consent building block. The response is paginated.
      operationId: serviceListDataAgreementRecordHistory
      tags:
        - service
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - $ref: '#/paths/~1service~1individual~1record/delete/parameters/0'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecordHistory:
                    required:
                      - id
                      - organisationId
                      - dataAgreementId
                      - log
                      - timestamp
                    type: object
                    title: ConsentRecordHistory
                    properties:
                      id:
                        type: string
                        description: Data agreement record history Id
                      organisationId:
                        type: string
                        description: Organisation Id
                      dataAgreementId:
                        type: string
                        description: Data agreement Id
                      log:
                        type: string
                        description: Log string
                      timestamp:
                        type: string
                        description: Timestamp in ISO 8601 date time format
                    example:
                      id: 64e91591e2f6a8000142c665
                      organisationId: 603e683c69dd720001c74f93
                      dataAgreementId: 61e183127c81650001f97d43
                      log: Updated consent value to <Allow> for the purpose <Customer Loyalty Card Issuance> in organization <The Retail Company (Germany)>
                      timestamp: '2023-08-25T20:56:49Z'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
      deprecated: false
      security:
        - BearerAuth: []
  /service/individual:
    post:
      summary: CREATE - Create individual
      description: This endpoint creates an individual for an organisation in the consent building block. This is used to onboard existing or new users.
      operationId: configCreatePolicy
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                individual:
                  allOf:
                    - $ref: '#/components/schemas/Individual'
                    - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                  description: An object of type Individual
              required:
                - individual
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                    description: An object of type Individual
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/individual/{individualId}':
    get:
      summary: READ - Read individual
      description: 'This endpoint is used to read the individual''s information as defined by the organisation in the consent building block. This is used in privacy dashboard where the individuals can mark their consents, sign data agreement etc.'
      operationId: configReadIndividual
      parameters:
        - in: path
          name: individualId
          description: Unique ID of an object
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
    put:
      summary: UPDATE - Update individual
      description: This endpoint is used to udpated an individual for an organisation defined in the consent building block.
      operationId: configUpdateIndividual
      parameters:
        - in: path
          name: individualId
          description: Unique ID of an object
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individual:
                    allOf:
                      - $ref: '#/components/schemas/Individual'
                      - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
        '400':
          description: bad input parameter
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                individual:
                  allOf:
                    - $ref: '#/components/schemas/Individual'
                    - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                  description: An object of type Individual
              required:
                - individual
      security:
        - BearerAuth: []
      tags:
        - service
  /service/individuals:
    get:
      summary: LIST - List all individuals
      description: LIST - lists individuals in the system This endpoint is used to list all individuals in the organisation defined in the consent building block.
      operationId: configListIndividuals
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties:
                  individuals:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/Individual'
                        - $ref: '#/paths/~1config~1individual/post/requestBody/content/application~1json/schema/properties/individual/allOf/1'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  '/service/image/{imageId}':
    get:
      summary: READ - Read organisation image
      description: This endpoint is used to read an organisation image as defined in the consent building block.
      operationId: serviceReadOrganisationImage
      deprecated: false
      responses:
        '200':
          headers: {}
      security:
        - BearerAuth: []
      tags:
        - service
  /service/data-sharing:
    get:
      summary: READ - Read data sharing UI
      description: This endpoint is used to render the data sharing UI during a data exchange as defined by a (data source) organisation in the consent building block.
      operationId: serviceReadDataSharingUi
      parameters:
        - name: dataAgreementId
          in: query
          description: ID for data agreement
          required: true
          schema:
            type: string
        - name: accessToken
          in: query
          description: Access token for authentication
          required: false
          schema:
            type: string
        - name: apiKey
          in: query
          description: API key for authorization
          required: false
          schema:
            type: string
        - name: individualId
          in: query
          description: ID for the individual
          required: false
          schema:
            type: string
        - name: thirdPartyOrgName
          in: query
          description: Name of the third-party organization
          required: true
          schema:
            type: string
        - name: thirdPartyOrgLogoImageUrl
          in: query
          description: URL for the third-party organization's logo image
          required: false
          schema:
            type: string
        - name: dataSharingUiRedirectUrl
          in: query
          description: Redirect URL for data sharing UI
          required: true
          schema:
            type: string
        - name: code
          in: query
          description: Authorization code
          required: false
          schema:
            type: string
        - name: authorisationRedirectUrl
          in: query
          description: Redirect URL for authorization
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Ok
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - service
  /audit/admin/logs:
    get:
      summary: LIST - Fetch all organisational logs
      description: This endpoint is used to list all logs with pagination for an organisation defined in the consent building block.
      operationId: auditAdminLogs
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - name: logType
          in: query
          description: Type of the log
          required: false
          schema:
            type: integer
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  logs:
                    items:
                      description: A human readable log
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            description: ID for organisation log
                          type:
                            type: integer
                            description: Type integer for organisation log
                          typeStr:
                            type: string
                            description: Type string for organisation log
                          userId:
                            type: string
                            description: User ID
                          username:
                            type: string
                          timestamp:
                            type: string
                          log:
                            type: string
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
      tags:
        - audit
  /audit/consent-records:
    get:
      summary: LIST - Fetch all consent records
      description: This endpoint is used to fetch all consent records with pagination for individuals in an organisation defined in the consent building block.
      operationId: auditDataAgreementRecordsList
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
        - description: Unique ID of an object
          in: query
          name: lawfulBasis
          schema:
            type: string
            description: Lawful basis of the agreement - consent / legal_obligation / contract / vital_interest / public_task / legitimate_interest
            enum:
              - consent
              - legal_obligation
              - contract
              - vital_interest
              - public_task
              - legitimate_interest
        - description: 'ID contains indivitual id, data agreement id or consent record id'
          in: query
          name: id
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecords:
                    items:
                      allOf:
                        - $ref: '#/components/schemas/ConsentRecord'
                        - type: object
                          properties:
                            timestamp:
                              type: string
                            dataAgreement:
                              type: object
                              properties:
                                version:
                                  type: string
                                  description: Version of data agreement
                                purpose:
                                  type: string
                                  description: Name of purpose
                                lawfulBasis:
                                  type: string
                                  format: ''
                                  example: ''
                                  description: Lawful basis of the agreement - consent / legal_obligation / contract / vital_interest / public_task / legitimate_interest
                                  enum:
                                    - consent
                                    - legal_obligation
                                    - contract
                                    - vital_interest
                                    - public_task
                                    - legitimate_interest
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - audit
  '/audit/consent-record/{consentRecordId}':
    get:
      summary: READ - Get consent record
      description: This endpoint is used to get a single consent record by ID in an organisation defined in the consent building block.
      operationId: auditConsentRecordRead
      parameters:
        - description: Unique ID of an object
          in: path
          name: consentRecordId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  consentRecord:
                    $ref: '#/components/schemas/ConsentRecord'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - audit
  /audit/data-agreements:
    get:
      summary: LIST - Fetch all data agreements
      description: This endpoint is used to fetch all data agreements defined in the consent building block.
      operationId: auditDataAgreementList
      parameters:
        - $ref: '#/paths/~1config~1policies/get/parameters/1'
        - $ref: '#/paths/~1config~1policies/get/parameters/2'
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreements:
                    items:
                      $ref: '#/components/schemas/DataAgreement'
                    type: array
                  pagination:
                    $ref: '#/components/schemas/Pagination'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - audit
  '/audit/data-agreement/{dataAgreementId}':
    get:
      summary: READ - Get data agreement
      description: 'This endpoint is used to fetch a single data agreement for audit purposes, for e.g., by an external third party.'
      operationId: auditReadRecord
      parameters:
        - description: Unique ID of an object
          in: path
          name: dataAgreementId
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  dataAgreement:
                    $ref: '#/components/schemas/DataAgreement'
          description: ''
        '400':
          description: bad input parameter
      security:
        - BearerAuth: []
      tags:
        - audit
servers:
  - description: Development server
    url: 'https://api.bb-consent.dev/v2'
  - description: Staging server
    url: 'https://staging-consent-bb-api.igrant.io/v2'
  - description: Demo server
    url: 'https://demo-consent-bb-api.igrant.io/v2'
tags:
  - description: This consists of endpoints for an external auditing systems or for organisational to query consent record from consent building block.
    name: audit
    x-tag-expanded: false
  - description: 'This consists of ndpoints available to organisation admins to manage data agreements, data agreement records, consents and consent records. It also provides mechanisms onboard the organisation to consent building block.'
    name: config
    x-tag-expanded: false
  - description: 'This consists of endpoints towards individuals, data consumers and applications to view, sign/record their agreement to the processing of personal data. In cases where the data agreement is of legal basis consent and for legitimate interest, the individual can opt-in and opt-out at any stage.'
    name: service
    x-tag-expanded: false
  - description: This consists of endpoints towards organisation admin to onboard to consent building block. It also deals with all authentication and authorisation APIs that can be configured towards external IDPs (e.g. using OpenID Connect).
    name: onboard
    x-tag-expanded: false
