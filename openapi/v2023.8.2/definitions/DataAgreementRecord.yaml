required:
  - data_agreement
  - data_agreement_revision
  - individual
  - opt_in
type: object
description: |
  A Consent Record expresses consent (as defined in this building block's specification) to a single Agreement. 
  There must be a UNIQUE constraint on (agreement_revision, individual)
properties:
  id:
    type: string
    format: uuid
    example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
    description: |
      Objects may be passed back by some API endpoints without an id (PK), denoting that they are a \"draft\", 
      i.e. a ConsentRecord that is not yet stored in the database and only exist in transit. 
      Draft ConsentRecords do not have a Revision, but if paired up with a Signature, a valid Revision should be generated.
  data_agreement:
    description: Data agreement
    $ref: "./DataAgreement.yaml"
  data_agreement_revision:
    description: Data agreement revision
    $ref: "./Revision.yaml"
  individual:
    description: Individual to whom this data agreement record belongs to
    $ref: "./Individual.yaml"
  opt_in:
    type: boolean
    description: "True: The individual has positively opted in. False: The individual has explicitly said no (or withdrawn a previous consent)."
  state:
    type: string
    description: "The state field is used to record state changes after-the-fact. It is maintained by the Consent BB itself. Valid states: unsigned/pending more signatures/signed"
  signature:
    $ref: "./Signature.yaml"
